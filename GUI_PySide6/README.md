# arc_pttcul

使用python爬虫爬取定数表，并进行b30等的存储与计算。

随手做的小玩意，感觉。。。不如excel。唯一的区别就是加了个爬定数表。

## 导入用户数据

只是爬定数表，用户数据还是要自己输入。如果之前自己做了excel表，只要按`曲名 难度 定数 成绩 潜力值`的表头导出csv，再替换`user_data_table.csv`文件就行了。**注意**：`user_data_table.csv`需要以`utf-8`的编码保存。

## 打包程序

使用`PyInstaller`进行单文件打包。~~打包好的程序在dist目录下。~~
见release发行版，不再同步至git仓库。

## 初始化

初次使用需要先生成两个表格。启动程序，先使用`初始化`选项生成定数表`chart_constant_table.csv`和用户数据表`user_data_table.csv`。也可以自己导入用户数据，方法见上。

如果你无法成功初始化，可以下载使用csv示例中的文件，清空用户数据表`user_data_table.csv`的内容就行。

## 爬取定数表相关

**报错SSLError**：

请关闭代理后重试。

**程序无响应**：

1. 可能是网页访问速度过慢，请耐心等待。这个问题将在将来的更新计划中被解决。
2. 可能是爬虫被检测到导致IP被封。可以临时使用手动输入成绩。这个问题将在将来的更新计划中被解决。

## 同名曲消歧义

目前游戏中存在Quon和Genesis两个曲名四首同名曲。

从中文维基爬取的定数表未消歧义，而英文维基爬取的定数表通过在曲名中添加艺术家的方式进行了消歧义。这是由于双方存定数表的方式不同，所以实现起来也有一点差别。这可能导致混用cn和en定数表时出现一些小问题。可以改，下版本再说。

消歧义方式是写死在程序里的，这意味着如果未来出现新的同名曲，如果作者已经不在更新这个项目可能导致一些问题。

## 待办事项

* [ ] 爬虫添加代理：通过代理加速enwiki的访问速度以爬取定数表。

* [ ] 爬虫优化：因为写的爬虫太简单，用一段时间后可能会被Cloudflare等CDN服务商封ip，需要优化。

* [ ] b30出图：应该能做，看别人做过，等有空。

* [ ] ocr识别：画个饼。本来是想着上传成绩图就能ocr识别曲名难度成绩这种，玩家只需要定期上传成绩截图不需要手动输入。但存在很多难点。首先游戏中有四首同名歌曲，光识别名字不行。然后部分角色立绘会遮挡曲名和分数。最后就是ocr我一窍不通只是个想法XD。
